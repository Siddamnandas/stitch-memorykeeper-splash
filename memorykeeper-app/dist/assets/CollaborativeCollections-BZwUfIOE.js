import{c as A,u as L,r as o,j as e,h as y,z as _,Y as v,_ as z,X as T,Q as w,al as M,m as O,aw as U}from"./ai-studio-D1VHpCnl.js";import{a as V}from"./game-components-DlDolkYV.js";import{c as x}from"./collaborativeMemoryService-C774JkFX.js";import"./index-BYmrHuMl.js";const Q=({onBack:g})=>{const{user:i}=V(),{addToast:a}=A(),{dispatch:N}=L(),[u,C]=o.useState([]),[k,S]=o.useState(!0),[I,n]=o.useState(!1),[b,m]=o.useState(null),[p,E]=o.useState([]),[r,c]=o.useState({title:"",description:"",isPublic:!1}),[l,d]=o.useState({email:"",permission:"view",message:""});o.useEffect(()=>{h(),f()},[i==null?void 0:i.id]);const h=async()=>{if(i!=null&&i.id)try{const s=await x.getUserCollaborativeCollections(i.id);s.data&&C(s.data)}catch(s){console.error("Error loading collections:",s),a({type:"error",title:"Error",message:"Failed to load collaborative collections.",duration:4e3})}finally{S(!1)}},f=async()=>{E([])},F=async()=>{if(!r.title.trim()){a({type:"error",title:"Validation Error",message:"Collection title is required.",duration:4e3});return}try{const s=await x.createCollaborativeCollection(r.title,r.description,r.isPublic);if(s.success)a({type:"success",title:"Collection Created",message:`"${r.title}" has been created successfully.`,duration:4e3}),c({title:"",description:"",isPublic:!1}),n(!1),await h();else throw new Error(s.error)}catch(s){a({type:"error",title:"Creation Failed",message:s.message||"Failed to create collection.",duration:5e3})}},P=async s=>{if(!l.email.trim()){a({type:"error",title:"Validation Error",message:"Email address is required.",duration:4e3});return}try{const t=await x.inviteUserToCollection(s,l.email,l.permission,l.message);if(t.success)a({type:"success",title:"Invite Sent",message:`Invitation sent to ${l.email}.`,duration:4e3}),d({email:"",permission:"view",message:""}),m(null);else throw new Error(t.error)}catch(t){a({type:"error",title:"Invite Failed",message:t.message||"Failed to send invitation.",duration:5e3})}},D=async s=>{try{const t=await x.acceptCollaborationInvite(s);if(t.success)a({type:"success",title:"Invite Accepted",message:"You have joined the collaborative collection.",duration:4e3}),await h(),await f();else throw new Error(t.error)}catch(t){a({type:"error",title:"Accept Failed",message:t.message||"Failed to accept invitation.",duration:5e3})}},j=()=>{g?g():N({type:"SET_DETAIL_VIEW",payload:null})};return k?e.jsx("div",{className:"pt-6 space-y-8",children:e.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[e.jsx("button",{onClick:j,className:"w-10 h-10 bg-white/80 backdrop-blur-xl rounded-2xl flex items-center justify-center shadow-lg border border-orange-100 hover:bg-orange-50 transition-colors","aria-label":"Go back",children:e.jsx(y,{className:"w-6 h-6 text-gray-700"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Collaborative Collections"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Loading..."})]})]})}):e.jsxs("div",{className:"pt-6 space-y-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:j,className:"w-10 h-10 bg-white/80 backdrop-blur-xl rounded-2xl flex items-center justify-center shadow-lg border border-orange-100 hover:bg-orange-50 transition-colors","aria-label":"Go back",children:e.jsx(y,{className:"w-6 h-6 text-gray-700"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Collaborative Collections"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Share memories with family and friends"})]})]}),e.jsxs("button",{onClick:()=>n(!0),className:"flex items-center gap-2 bg-gradient-to-r from-orange-500 to-rose-500 text-white px-4 py-2 rounded-xl font-semibold shadow-lg hover:shadow-xl transition-all",children:[e.jsx(_,{className:"w-4 h-4"}),"Create Collection"]})]}),p.length>0&&e.jsxs("div",{className:"bg-white/80 backdrop-blur-xl rounded-3xl p-6 shadow-xl border border-orange-100",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-800 mb-4",children:"Pending Invites"}),e.jsx("div",{className:"space-y-3",children:p.map(s=>e.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-2xl",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(v,{className:"w-8 h-8 text-blue-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-800",children:"Invited to collaborate"}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Expires: ",new Date(s.expires_at).toLocaleDateString()]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>D(s.id),className:"flex items-center gap-2 bg-green-500 text-white px-4 py-2 rounded-lg hover:bg-green-600 transition-colors",children:[e.jsx(z,{className:"w-4 h-4"}),"Accept"]}),e.jsxs("button",{className:"flex items-center gap-2 bg-gray-300 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-400 transition-colors",children:[e.jsx(T,{className:"w-4 h-4"}),"Decline"]})]})]},s.id))})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[u.map(s=>e.jsxs("div",{className:"bg-white/80 backdrop-blur-xl rounded-3xl p-6 shadow-xl border border-orange-100",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-800",children:s.title}),s.description&&e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:s.description})]}),e.jsx("button",{onClick:()=>m(s.id),className:"w-8 h-8 flex items-center justify-center bg-orange-100 rounded-lg hover:bg-orange-200 transition-colors","aria-label":"Invite collaborators",children:e.jsx(v,{className:"w-4 h-4 text-orange-600"})})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-600 mb-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(w,{className:"w-4 h-4"}),e.jsxs("span",{children:[s.collaborators.length," members"]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(M,{className:"w-4 h-4"}),e.jsxs("span",{children:[s.shared_memories.length," memories"]})]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(O,{className:"w-4 h-4"}),e.jsx("span",{children:new Date(s.updated_at).toLocaleDateString()})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{className:"flex-1 bg-gradient-to-r from-blue-500 to-cyan-500 text-white px-4 py-2 rounded-xl font-semibold hover:shadow-lg transition-all",children:"Open Collection"}),e.jsx("button",{className:"px-3 py-2 bg-gray-100 rounded-xl hover:bg-gray-200 transition-colors",children:e.jsx(U,{className:"w-4 h-4 text-gray-600"})})]})]},s.id)),u.length===0&&e.jsxs("div",{className:"col-span-full bg-white/80 backdrop-blur-xl rounded-3xl p-12 shadow-xl border border-orange-100 text-center",children:[e.jsx(w,{className:"w-16 h-16 text-orange-300 mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-bold text-gray-800 mb-2",children:"No Collaborative Collections"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"Create your first collection to start sharing memories with family and friends."}),e.jsx("button",{onClick:()=>n(!0),className:"bg-gradient-to-r from-orange-500 to-rose-500 text-white px-6 py-3 rounded-xl font-semibold shadow-lg hover:shadow-xl transition-all",children:"Create Your First Collection"})]})]}),I&&e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-3xl p-6 shadow-2xl max-w-md w-full",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-800 mb-6",children:"Create Collaborative Collection"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Collection Title *"}),e.jsx("input",{type:"text",value:r.title,onChange:s=>c(t=>({...t,title:s.target.value})),placeholder:"e.g., Family Memories 2024",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description (Optional)"}),e.jsx("textarea",{value:r.description,onChange:s=>c(t=>({...t,description:s.target.value})),placeholder:"Describe what this collection is about...",rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent resize-none"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",id:"isPublic",checked:r.isPublic,onChange:s=>c(t=>({...t,isPublic:s.target.checked})),className:"w-4 h-4 text-orange-600 border-gray-300 rounded focus:ring-orange-500"}),e.jsx("label",{htmlFor:"isPublic",className:"text-sm text-gray-700",children:"Make this collection public"})]})]}),e.jsxs("div",{className:"flex gap-3 mt-6",children:[e.jsx("button",{onClick:()=>n(!1),className:"flex-1 py-3 px-4 bg-gray-200 text-gray-700 rounded-xl font-semibold hover:bg-gray-300 transition-colors",children:"Cancel"}),e.jsx("button",{onClick:F,className:"flex-1 py-3 px-4 bg-gradient-to-r from-orange-500 to-rose-500 text-white rounded-xl font-semibold shadow-lg hover:shadow-xl transition-all",children:"Create Collection"})]})]})}),b&&e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-3xl p-6 shadow-2xl max-w-md w-full",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-800 mb-6",children:"Invite Collaborator"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email Address *"}),e.jsx("input",{type:"email",value:l.email,onChange:s=>d(t=>({...t,email:s.target.value})),placeholder:"friend@example.com",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Permission Level"}),e.jsxs("select",{value:l.permission,onChange:s=>d(t=>({...t,permission:s.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent",children:[e.jsx("option",{value:"view",children:"View Only - Can see memories"}),e.jsx("option",{value:"edit",children:"Edit - Can add and modify memories"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Personal Message (Optional)"}),e.jsx("textarea",{value:l.message,onChange:s=>d(t=>({...t,message:s.target.value})),placeholder:"Share a personal message with your invitation...",rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent resize-none"})]})]}),e.jsxs("div",{className:"flex gap-3 mt-6",children:[e.jsx("button",{onClick:()=>m(null),className:"flex-1 py-3 px-4 bg-gray-200 text-gray-700 rounded-xl font-semibold hover:bg-gray-300 transition-colors",children:"Cancel"}),e.jsx("button",{onClick:()=>P(b),className:"flex-1 py-3 px-4 bg-gradient-to-r from-orange-500 to-rose-500 text-white rounded-xl font-semibold shadow-lg hover:shadow-xl transition-all",children:"Send Invite"})]})]})})]})};export{Q as default};
//# sourceMappingURL=CollaborativeCollections-BZwUfIOE.js.map
