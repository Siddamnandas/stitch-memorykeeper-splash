import{r,j as e,h as Q,m as U,Q as H,W as Z,J as K,Y as E,_ as z,X as O,z as ee,I as te,$ as ae,f as se,a0 as re,a1 as ne}from"./ai-studio-D1VHpCnl.js";import{a as le}from"./game-components-DlDolkYV.js";import{c as k}from"./collaborativeMemoryService-C774JkFX.js";import"./index-BYmrHuMl.js";const l="https://lh3.googleusercontent.com/aida-public/AB6AXuAGex1pX93qBbizGrdKH51pL50dkK1pYVYeDl-jBpxT5AWJ6xDM2D847ZTKkaLBCVXWtdVnOvuKCPLz7Hxoh4YyR66U_Yd3XQoJG8si9PcqMgUtlbKBnIQISsjSwVHjXVdqm9-CR_5N3wkNGigpRybhW-ZmBoszQWkL3MBeDgFciIJGZViCWhsO0jUsSY0TvPAtEbLfOZBIqERmFT69xGf5lbSqjL4Ao2BZHzGatQINlKmQZ5V3FE_bCJ_mBeuAmA1BnGvaVrv7d0M",be=({onBack:X})=>{const{user:n}=le(),S=(n==null?void 0:n.email)||"",[c,b]=r.useState("family"),[oe,de]=r.useState(""),[ie,ce]=r.useState(new Set),[me,xe]=r.useState(new Set),[g,A]=r.useState("email"),[h,I]=r.useState(""),[F,u]=r.useState(!1),[L,B]=r.useState([{id:"1",name:"Jennifer",avatar:l,relationship:"Daughter",status:"connected",sharedMemories:12},{id:"2",name:"Michael",avatar:l,relationship:"Son",status:"pending",sharedMemories:0},{id:"3",name:"Emma",avatar:l,relationship:"Granddaughter",status:"connected",sharedMemories:5}]),[j,V]=r.useState([{id:"1",userId:"1",userName:"Jennifer",userAvatar:l,action:"added_memory",target:"Mom's 75th Birthday Party",content:"Added a new photo",timestamp:"2 hours ago",read:!1},{id:"2",userId:"3",userName:"Emma",userAvatar:l,action:"commented",target:"Summer of '68",content:"I love this story, Grandma!",timestamp:"Yesterday",read:!0},{id:"3",userId:"current",userName:"You",userAvatar:l,action:"shared",target:"Wedding Day 1972",content:"Shared with family",timestamp:"3 days ago",read:!0}]),[N,v]=r.useState([{id:"1",userId:"1",userName:"Jennifer",userAvatar:l,type:"photo",content:"https://lh3.googleusercontent.com/aida-public/AB6AXuA6Xa6PIYrJVFAmDgm1pDK2DeY0iWkW-vIDXGx07EmFACCiAyvQBF-wF0h4AteLCfhdP846C_wC2H78W6pLGXVSHX8aC2daiuU30s4BhS4JXEAknt0P2-rcgio7iOsSPaiZBjou0iqPRN4Qi6-XCjS4xgW55wsTUVSoqH8YMrmL1tYu87DkqyMqcd2Q1AIf7r8wbRZXb2ueiVLsbKLIlICMSk8L6Gl7Ppxc1L_CPbCvnAGWJ5P3TRfESBEIsoC33bjvWXiqQZR_dTg",caption:"Family reunion photo",date:"1985",relatedPeople:["Margaret","Michael"],timestamp:"1 hour ago"}]),[G,R]=r.useState([{id:"1",author:"Grandma",avatar:l,text:"This is a wonderful memory to share!",timestamp:"2d",likes:3,memoryId:"1"},{id:"2",author:"Uncle Mark",avatar:l,text:"I love the photos we added!",timestamp:"1d",likes:5,memoryId:"2"}]),[W,y]=r.useState(!0),[M,P]=r.useState(null);r.useEffect(()=>{if(!(n!=null&&n.id)){y(!1);return}let t=!1;return(async()=>{try{y(!0);const[o,w,C]=await Promise.all([k.getUserCollaborativeCollections(n.id),k.getSharedMemoriesWithMe(n.id),k.getInvitesForUser(n.id,S)]);if(t)return;if(o.data&&o.data.length>0){const i=o.data.map(a=>{var x,p,$,D;const s=(x=a.profiles)==null?void 0:x.full_name,d=(p=a.permissions)==null?void 0:p[n.id];return{id:a.id,name:a.title||"Shared Collection",avatar:(($=a.profiles)==null?void 0:$.avatar_url)||l,relationship:s?`${s}'s collection`:"Shared collection",status:d==="edit"||d==="admin"?"connected":"pending",sharedMemories:((D=a.shared_memories)==null?void 0:D.length)??0}});i.length>0&&B(i)}if(w.data&&w.data.length>0){const i=w.data.map(a=>{var s,d,x,p;return{id:a.id,userId:a.shared_by_user_id,userName:((s=a.profiles)==null?void 0:s.full_name)||"Family member",userAvatar:((d=a.profiles)==null?void 0:d.avatar_url)||l,action:"shared",target:((x=a.memories)==null?void 0:x.prompt)||"Shared memory",content:a.message||((p=a.memories)==null?void 0:p.response)||"",timestamp:new Date(a.created_at).toLocaleString(),read:!0}});if(i.length>0){V(i);const a=i.filter(s=>s.content).map((s,d)=>({id:`${s.id}-comment-${d}`,author:s.userName,avatar:s.userAvatar,text:s.content,timestamp:s.timestamp,likes:0,memoryId:s.id}));a.length>0&&R(a)}}if(C.data&&C.data.length>0){const i=C.data.map(a=>{var s,d,x;return{id:a.id,userId:a.invited_by_user_id||"",userName:((s=a.inviter)==null?void 0:s.full_name)||"Family member",userAvatar:((d=a.inviter)==null?void 0:d.avatar_url)||l,type:"text",content:a.message||"New contribution awaiting review",caption:((x=a.collaborative_collections)==null?void 0:x.title)||"Shared collection",date:a.expires_at?new Date(a.expires_at).toLocaleDateString():new Date(a.created_at).toLocaleDateString(),relatedPeople:[],timestamp:new Date(a.created_at).toLocaleString()}});i.length>0&&v(i)}P(null)}catch(o){console.error("Failed to load collaborative data:",o),t||P("Unable to load the latest collaboration updates. Showing recent snapshot instead.")}finally{t||y(!1)}})(),()=>{t=!0}},[n==null?void 0:n.id,S]);const _=()=>{u(!0)},T=()=>{if(g==="email"&&h)console.log(`Sending invite to ${h}`),alert(`Invitation sent to ${h}!`),I(""),u(!1);else if(g==="link"){const t=`${window.location.origin}/invite/${Math.random().toString(36).substring(2,15)}`;navigator.clipboard.writeText(t),alert("Invite link copied to clipboard!"),u(!1)}},q=()=>{console.log("Save clicked"),alert("Memory saved successfully!")},f=t=>{console.log(`Adding ${t} to memory`),alert(`Add ${t} functionality would open here`)},Y=t=>{v(m=>m.filter(o=>o.id!==t)),alert("Contribution approved and added to scrapbook!")},J=t=>{v(m=>m.filter(o=>o.id!==t)),alert("Contribution declined.")};return e.jsxs("div",{className:"pt-6",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[e.jsx("button",{onClick:X,className:"w-10 h-10 bg-white/80 backdrop-blur-xl rounded-2xl flex items-center justify-center shadow-lg border border-orange-100",children:e.jsx(Q,{className:"w-6 h-6 text-gray-700"})}),e.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Family Circle"})]}),W&&e.jsxs("div",{className:"bg-white/70 border border-orange-100 rounded-2xl p-3 mb-4 text-sm text-gray-600 flex items-center gap-2",children:[e.jsx(U,{className:"w-4 h-4 text-orange-500"}),"Loading the latest collaboration updates…"]}),M&&e.jsx("div",{className:"bg-orange-50 border border-orange-200 text-orange-700 text-sm rounded-2xl p-3 mb-4",children:M}),e.jsxs("div",{className:"bg-white/80 backdrop-blur-xl rounded-3xl p-6 shadow-xl border border-orange-100 mb-6",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-orange-50 rounded-2xl p-3 text-center",children:[e.jsx(H,{className:"w-6 h-6 text-orange-600 mx-auto mb-1"}),e.jsx("p",{className:"text-sm font-bold text-gray-800",children:L.filter(t=>t.status==="connected").length}),e.jsx("p",{className:"text-xs text-gray-600",children:"Connected"})]}),e.jsxs("div",{className:"bg-amber-50 rounded-2xl p-3 text-center",children:[e.jsx(Z,{className:"w-6 h-6 text-amber-600 mx-auto mb-1"}),e.jsx("p",{className:"text-sm font-bold text-gray-800",children:j.filter(t=>!t.read).length}),e.jsx("p",{className:"text-xs text-gray-600",children:"Unread"})]}),e.jsxs("div",{className:"bg-rose-50 rounded-2xl p-3 text-center",children:[e.jsx(K,{className:"w-6 h-6 text-rose-600 mx-auto mb-1"}),e.jsx("p",{className:"text-sm font-bold text-gray-800",children:G.reduce((t,m)=>t+m.likes,0)}),e.jsx("p",{className:"text-xs text-gray-600",children:"Likes"})]})]}),e.jsxs("div",{className:"flex border-b border-orange-200 mb-6",children:[e.jsx("button",{className:`pb-3 px-4 font-medium text-sm ${c==="family"?"text-orange-600 border-b-2 border-orange-600":"text-gray-500"}`,onClick:()=>b("family"),children:"Family"}),e.jsxs("button",{className:`pb-3 px-4 font-medium text-sm ${c==="activity"?"text-orange-600 border-b-2 border-orange-600":"text-gray-500"}`,onClick:()=>b("activity"),children:["Activity (",j.filter(t=>!t.read).length,")"]}),e.jsx("button",{className:`pb-3 px-4 font-medium text-sm ${c==="shared"?"text-orange-600 border-b-2 border-orange-600":"text-gray-500"}`,onClick:()=>b("shared"),children:"Shared"}),e.jsxs("button",{className:`pb-3 px-4 font-medium text-sm ${c==="pending"?"text-orange-600 border-b-2 border-orange-600":"text-gray-500"}`,onClick:()=>b("pending"),children:["Pending (",N.length,")"]})]}),c==="family"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"Connected Family"}),e.jsxs("button",{className:"flex items-center gap-1 py-2 px-3 bg-gradient-to-r from-orange-500 to-rose-500 text-white font-bold rounded-xl text-sm",onClick:_,children:[e.jsx(E,{className:"w-4 h-4"}),e.jsx("span",{children:"Invite"})]})]}),e.jsx("div",{className:"grid grid-cols-1 gap-4",children:L.map(t=>e.jsxs("div",{className:"flex items-center gap-4 p-4 bg-orange-50/50 rounded-2xl",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-cover bg-center",style:{backgroundImage:`url("${t.avatar}")`}}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-bold text-gray-800",children:t.name}),e.jsx("p",{className:"text-sm text-gray-600",children:t.relationship})]}),e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${t.status==="connected"?"bg-green-100 text-green-800":t.status==="pending"?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"}`,children:t.status==="connected"?"Connected":t.status==="pending"?"Pending":"Invited"})]}),e.jsxs("div",{className:"flex justify-between items-center mt-2",children:[e.jsxs("span",{className:"text-xs text-gray-600",children:[t.sharedMemories," shared memories"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{className:"text-orange-600 hover:text-orange-700 text-sm font-medium",children:"View Shared"}),t.status==="pending"&&e.jsx("button",{className:"text-gray-500 hover:text-gray-700 text-sm",children:"Resend"})]})]})]})]},t.id))})]}),c==="activity"&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"Recent Activity"}),j.map(t=>e.jsxs("div",{className:`flex items-start gap-3 p-3 rounded-2xl ${t.read?"":"bg-orange-50/50"}`,children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-cover bg-center",style:{backgroundImage:`url("${t.userAvatar}")`}}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-baseline gap-2",children:[e.jsx("p",{className:"font-bold text-gray-800 text-sm",children:t.userName}),e.jsx("p",{className:"text-gray-500 text-xs",children:t.timestamp}),!t.read&&e.jsx("span",{className:"w-2 h-2 bg-orange-500 rounded-full"})]}),e.jsxs("p",{className:"text-gray-700 text-sm",children:[t.action==="added_memory"&&`added a ${t.content} to "${t.target}"`,t.action==="commented"&&`commented on "${t.target}": "${t.content}"`,t.action==="shared"&&`shared "${t.target}" with family`,t.action==="approved"&&`approved a contribution to "${t.target}"`,t.action==="declined"&&`declined a contribution to "${t.target}"`]}),e.jsxs("div",{className:"flex gap-3 mt-2",children:[e.jsx("button",{className:"text-xs text-orange-600 hover:text-orange-700",children:"View"}),e.jsx("button",{className:"text-xs text-orange-600 hover:text-orange-700",children:"Comment"})]})]})]},t.id))]}),c==="shared"&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"Shared Memories"}),e.jsx("div",{className:"grid grid-cols-2 gap-3",children:[1,2,3,4,5,6].map(t=>e.jsx("div",{className:"aspect-square rounded-2xl overflow-hidden bg-orange-100 border border-orange-200",children:e.jsx("div",{className:"w-full h-full bg-cover bg-center",style:{backgroundImage:'url("https://lh3.googleusercontent.com/aida-public/AB6AXuA6Xa6PIYrJVFAmDgm1pDK2DeY0iWkW-vIDXGx07EmFACCiAyvQBF-wF0h4AteLCfhdP846C_wC2H78W6pLGXVSHX8aC2daiuU30s4BhS4JXEAknt0P2-rcgio7iOsSPaiZBjou0iqPRN4Qi6-XCjS4xgW55wsTUVSoqH8YMrmL1tYu87DkqyMqcd2Q1AIf7r8wbRZXb2ueiVLsbKLIlICMSk8L6Gl7Ppxc1L_CPbCvnAGWJ5P3TRfESBEIsoC33bjvWXiqQZR_dTg")'}})},t))}),e.jsx("button",{className:"w-full py-3 bg-orange-100 text-orange-700 font-bold rounded-2xl hover:bg-orange-200 transition-colors",children:"Load More"})]}),c==="pending"&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"Pending Approvals"}),N.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"text-4xl mb-4",children:"✅"}),e.jsx("p",{className:"text-gray-600",children:"No pending contributions"})]}):N.map(t=>e.jsxs("div",{className:"p-4 bg-orange-50/50 rounded-2xl border border-orange-100",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-cover bg-center",style:{backgroundImage:`url("${t.userAvatar}")`}}),e.jsxs("div",{children:[e.jsx("p",{className:"font-bold text-gray-800 text-sm",children:t.userName}),e.jsxs("p",{className:"text-xs text-gray-600",children:["wants to add a ",t.type," to a memory"]})]})]}),t.type==="photo"&&e.jsx("div",{className:"mb-3 rounded-xl overflow-hidden",children:e.jsx("div",{className:"w-full h-32 bg-cover bg-center",style:{backgroundImage:`url("${t.content}")`}})}),e.jsx("p",{className:"text-gray-700 text-sm mb-2",children:t.caption}),e.jsxs("div",{className:"flex flex-wrap gap-2 mb-3",children:[e.jsx("span",{className:"px-2 py-1 bg-amber-100 text-amber-800 rounded-full text-xs",children:t.date}),t.relatedPeople.map((m,o)=>e.jsx("span",{className:"px-2 py-1 bg-orange-100 text-orange-800 rounded-full text-xs",children:m},o))]}),e.jsxs("p",{className:"text-xs text-gray-500 mb-3",children:["Submitted ",t.timestamp]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{className:"flex-1 flex items-center justify-center gap-2 py-2 bg-gradient-to-r from-green-500 to-emerald-500 text-white font-bold rounded-xl",onClick:()=>Y(t.id),children:[e.jsx(z,{className:"w-4 h-4"}),e.jsx("span",{children:"Approve"})]}),e.jsxs("button",{className:"flex-1 flex items-center justify-center gap-2 py-2 bg-gradient-to-r from-red-500 to-rose-500 text-white font-bold rounded-xl",onClick:()=>J(t.id),children:[e.jsx(O,{className:"w-4 h-4"}),e.jsx("span",{children:"Decline"})]})]})]},t.id))]}),e.jsxs("div",{className:"pt-6 border-t border-orange-100 mt-6",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-800 mb-4",children:"Add to Memory"}),e.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[e.jsxs("div",{className:"flex flex-col items-center gap-2 text-center",children:[e.jsx("button",{className:"w-12 h-12 rounded-full bg-orange-100 flex items-center justify-center text-orange-700 hover:bg-orange-200 transition-colors",onClick:()=>f("text"),children:e.jsx(ee,{className:"w-6 h-6"})}),e.jsx("p",{className:"text-gray-700 text-sm font-medium",children:"Text"})]}),e.jsxs("div",{className:"flex flex-col items-center gap-2 text-center",children:[e.jsx("button",{className:"w-12 h-12 rounded-full bg-orange-100 flex items-center justify-center text-orange-700 hover:bg-orange-200 transition-colors",onClick:()=>f("photo"),children:e.jsx(te,{className:"w-6 h-6"})}),e.jsx("p",{className:"text-gray-700 text-sm font-medium",children:"Photo"})]}),e.jsxs("div",{className:"flex flex-col items-center gap-2 text-center",children:[e.jsx("button",{className:"w-12 h-12 rounded-full bg-orange-100 flex items-center justify-center text-orange-700 hover:bg-orange-200 transition-colors",onClick:()=>f("video"),children:e.jsx(ae,{className:"w-6 h-6"})}),e.jsx("p",{className:"text-gray-700 text-sm font-medium",children:"Video"})]}),e.jsxs("div",{className:"flex flex-col items-center gap-2 text-center",children:[e.jsx("button",{className:"w-12 h-12 rounded-full bg-orange-100 flex items-center justify-center text-orange-700 hover:bg-orange-200 transition-colors",onClick:()=>f("audio"),children:e.jsx(se,{className:"w-6 h-6"})}),e.jsx("p",{className:"text-gray-700 text-sm font-medium",children:"Audio"})]})]})]})]}),F&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-3xl p-6 w-full max-w-md",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-800",children:"Invite Family"}),e.jsx("button",{className:"text-gray-500 hover:text-gray-700",onClick:()=>u(!1),children:"✕"})]}),e.jsxs("div",{className:"flex gap-2 mb-4",children:[e.jsx("button",{className:`flex-1 py-2 rounded-xl font-medium ${g==="email"?"bg-orange-500 text-white":"bg-gray-100 text-gray-700"}`,onClick:()=>A("email"),children:"Email"}),e.jsx("button",{className:`flex-1 py-2 rounded-xl font-medium ${g==="link"?"bg-orange-500 text-white":"bg-gray-100 text-gray-700"}`,onClick:()=>A("link"),children:"Share Link"})]}),g==="email"?e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email Address"}),e.jsx("input",{type:"email",className:"w-full px-4 py-2 bg-orange-50 border border-orange-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-orange-300",placeholder:"Enter email address",value:h,onChange:t=>I(t.target.value)})]}):e.jsxs("div",{className:"mb-4 text-center py-4",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-12 h-12 rounded-full bg-orange-100 mb-3",children:e.jsx(re,{className:"w-6 h-6 text-orange-600"})}),e.jsx("p",{className:"text-gray-700",children:"A shareable link will be generated that you can send to your family member."})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{className:"flex-1 py-3 bg-gray-100 text-gray-700 font-bold rounded-2xl hover:bg-gray-200",onClick:()=>u(!1),children:"Cancel"}),e.jsx("button",{className:"flex-1 py-3 bg-gradient-to-r from-orange-500 to-rose-500 text-white font-bold rounded-2xl hover:shadow-xl transition-all",onClick:T,disabled:g==="email"&&!h,children:g==="email"?"Send Invite":"Generate Link"})]})]})}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 mb-6",children:[e.jsxs("button",{className:"flex items-center justify-center gap-2 py-3 px-4 bg-gradient-to-r from-amber-400 to-orange-400 text-white font-bold rounded-2xl shadow-lg hover:shadow-xl transition-all",onClick:_,children:[e.jsx(E,{className:"w-5 h-5"}),e.jsx("span",{children:"Invite"})]}),e.jsxs("button",{className:"flex items-center justify-center gap-2 py-3 px-4 bg-gradient-to-r from-green-500 to-emerald-500 text-white font-bold rounded-2xl shadow-lg hover:shadow-xl transition-all",onClick:q,children:[e.jsx(ne,{className:"w-5 h-5"}),e.jsx("span",{children:"Save"})]})]})]})};export{be as default};
//# sourceMappingURL=CollaborativeMemory-wWapY4fK.js.map
